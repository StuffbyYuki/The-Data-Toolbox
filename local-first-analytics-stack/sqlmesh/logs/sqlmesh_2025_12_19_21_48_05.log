2025-12-19 21:48:05,671 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:492)
2025-12-19 21:48:06,294 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:494)
2025-12-19 21:48:06,317 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:482)
2025-12-19 21:48:06,329 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0000_baseline' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0000_baseline.py'> (migrator.py:185)
2025-12-19 21:48:06,339 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0061_mysql_fix_blob_text_type' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0061_mysql_fix_blob_text_type.py'> (migrator.py:185)
2025-12-19 21:48:06,339 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0062_add_model_gateway' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0062_add_model_gateway.py'> (migrator.py:185)
2025-12-19 21:48:06,339 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0063_change_signals' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0063_change_signals.py'> (migrator.py:185)
2025-12-19 21:48:06,339 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0064_join_when_matched_strings' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0064_join_when_matched_strings.py'> (migrator.py:185)
2025-12-19 21:48:06,339 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0065_add_model_optimize' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0065_add_model_optimize.py'> (migrator.py:185)
2025-12-19 21:48:06,339 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0066_add_auto_restatements' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0066_add_auto_restatements.py'> (migrator.py:185)
2025-12-19 21:48:06,341 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0067_add_tsql_date_full_precision' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0067_add_tsql_date_full_precision.py'> (migrator.py:185)
2025-12-19 21:48:06,341 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0068_include_unrendered_query_in_metadata_hash' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0068_include_unrendered_query_in_metadata_hash.py'> (migrator.py:185)
2025-12-19 21:48:06,341 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0069_update_dev_table_suffix' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0069_update_dev_table_suffix.py'> (migrator.py:185)
2025-12-19 21:48:06,341 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0070_include_grains_in_metadata_hash' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0070_include_grains_in_metadata_hash.py'> (migrator.py:185)
2025-12-19 21:48:06,341 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0071_add_dev_version_to_intervals' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0071_add_dev_version_to_intervals.py'> (migrator.py:185)
2025-12-19 21:48:06,341 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0072_add_environment_statements' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0072_add_environment_statements.py'> (migrator.py:185)
2025-12-19 21:48:06,342 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0073_remove_symbolic_disable_restatement' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0073_remove_symbolic_disable_restatement.py'> (migrator.py:185)
2025-12-19 21:48:06,342 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0074_add_partition_by_time_column_property' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0074_add_partition_by_time_column_property.py'> (migrator.py:185)
2025-12-19 21:48:06,342 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0075_remove_validate_query' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0075_remove_validate_query.py'> (migrator.py:185)
2025-12-19 21:48:06,342 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0076_add_cron_tz' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0076_add_cron_tz.py'> (migrator.py:185)
2025-12-19 21:48:06,342 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0077_fix_column_type_hash_calculation' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0077_fix_column_type_hash_calculation.py'> (migrator.py:185)
2025-12-19 21:48:06,342 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0078_warn_if_non_migratable_python_env' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0078_warn_if_non_migratable_python_env.py'> (migrator.py:185)
2025-12-19 21:48:06,342 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0079_add_gateway_managed_property' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0079_add_gateway_managed_property.py'> (migrator.py:185)
2025-12-19 21:48:06,342 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0080_add_batch_size_to_scd_type_2_models' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0080_add_batch_size_to_scd_type_2_models.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0081_update_partitioned_by' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0081_update_partitioned_by.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0082_warn_if_incorrectly_duplicated_statements' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0082_warn_if_incorrectly_duplicated_statements.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0083_use_sql_for_scd_time_data_type_data_hash' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0083_use_sql_for_scd_time_data_type_data_hash.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0084_normalize_quote_when_matched_and_merge_filter' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0084_normalize_quote_when_matched_and_merge_filter.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0085_deterministic_repr' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0085_deterministic_repr.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0086_check_deterministic_bug' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0086_check_deterministic_bug.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0087_normalize_blueprint_variables' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0087_normalize_blueprint_variables.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0088_warn_about_variable_python_env_diffs' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0088_warn_about_variable_python_env_diffs.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0089_add_virtual_environment_mode' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0089_add_virtual_environment_mode.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0090_add_forward_only_column' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0090_add_forward_only_column.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0091_on_additive_change' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0091_on_additive_change.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0092_warn_about_dbt_data_type_diff' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0092_warn_about_dbt_data_type_diff.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0093_use_raw_sql_in_fingerprint' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0093_use_raw_sql_in_fingerprint.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0094_add_dev_version_and_fingerprint_columns' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0094_add_dev_version_and_fingerprint_columns.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0095_warn_about_dbt_raw_sql_diff' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0095_warn_about_dbt_raw_sql_diff.py'> (migrator.py:185)
2025-12-19 21:48:06,343 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0096_remove_plan_dags_table' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0096_remove_plan_dags_table.py'> (migrator.py:185)
2025-12-19 21:48:06,344 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0097_add_dbt_name_in_node' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0097_add_dbt_name_in_node.py'> (migrator.py:185)
2025-12-19 21:48:06,344 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0098_add_dbt_node_info_in_node' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0098_add_dbt_node_info_in_node.py'> (migrator.py:185)
2025-12-19 21:48:06,344 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0099_add_last_altered_to_intervals' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0099_add_last_altered_to_intervals.py'> (migrator.py:185)
2025-12-19 21:48:06,344 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Applying migration <module 'sqlmesh.migrations.v0100_add_grants_and_grants_target_layer' from '/Users/yuki/Desktop/Personal Stuff/The-Data-Toolbox/local-first-analytics-stack/.venv/lib/python3.12/site-packages/sqlmesh/migrations/v0100_add_grants_and_grants_target_layer.py'> (migrator.py:185)
2025-12-19 21:48:06,344 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Fetching environments (migrator.py:207)
2025-12-19 21:48:06,345 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - Migrating snapshot rows... (migrator.py:224)
2025-12-19 21:48:06,345 - MainThread - sqlmesh.core.state_sync.db.migrator - INFO - No changes to snapshots detected (migrator.py:217)
2025-12-19 21:48:08,327 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:123)
2025-12-19 21:48:08,342 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:123)
2025-12-19 21:48:08,343 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__sqlmesh_example' (evaluator.py:1449)
2025-12-19 21:48:08,343 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__sqlmesh_example" (base.py:2619)
2025-12-19 21:48:08,343 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:123)
2025-12-19 21:48:08,346 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:1616)
2025-12-19 21:48:08,346 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-19 21:48:08,346 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-19 21:48:08,347 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__full_model__635791289', 'sqlmesh_example__seed_model__2437004170', 'sqlmesh_example__incremental_model__3572673861') (base.py:2619)
2025-12-19 21:48:08,349 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."seed_model": 3962673666> (evaluator.py:711)
2025-12-19 21:48:08,350 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__2437004170' (evaluator.py:2042)
2025-12-19 21:48:08,350 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-19 21:48:08,350 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'db' (base.py:2619)
2025-12-19 21:48:08,351 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2437004170" ("id" INT, "item_id" INT, "event_date" DATE) (base.py:2619)
2025-12-19 21:48:08,359 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-19 21:48:08,359 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-19 21:48:08,360 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh__sqlmesh_example') AND table_name IN ('sqlmesh_example__seed_model__2437004170') (base.py:2619)
2025-12-19 21:48:08,363 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-19 21:48:08,364 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'db' (base.py:2619)
2025-12-19 21:48:08,365 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2437004170" AS SELECT CAST("id" AS INT) AS "id", CAST("item_id" AS INT) AS "item_id", CAST("event_date" AS DATE) AS "event_date" FROM (SELECT "id", "item_id", "event_date" FROM "db"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__seed_model__2437004170_wgtcd7o1") AS "_subquery" (base.py:2619)
2025-12-19 21:48:08,365 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__seed_model__2437004170_wgtcd7o1" (base.py:2619)
2025-12-19 21:48:08,366 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-12-19 00:00:00, 2025-12-20 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."seed_model": 3962673666> (facade.py:637)
2025-12-19 21:48:08,366 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."seed_model": 3962673666> (interval.py:215)
2025-12-19 21:48:08,370 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating a physical table for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 931077548> (evaluator.py:870)
2025-12-19 21:48:08,373 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__3572673861' (evaluator.py:2042)
2025-12-19 21:48:08,373 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-19 21:48:08,374 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'db' (base.py:2619)
2025-12-19 21:48:08,374 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3572673861" ("id" INT, "item_id" INT, "event_date" DATE) (base.py:2619)
2025-12-19 21:48:08,374 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'sqlmesh_example.incremental_model' (evaluator.py:2064)
2025-12-19 21:48:08,375 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT "seed_model"."id" AS "id", "seed_model"."item_id" AS "item_id", "seed_model"."event_date" AS "event_date" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2437004170" AS "seed_model" WHERE ("seed_model"."event_date" <= CAST('1970-01-01' AS DATE) AND "seed_model"."event_date" >= CAST('1970-01-01' AS DATE)) AND FALSE LIMIT 0 (base.py:2619)
2025-12-19 21:48:08,375 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 931077548> (evaluator.py:711)
2025-12-19 21:48:08,375 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 931077548> (evaluator.py:952)
2025-12-19 21:48:08,378 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2020-01-01 00:00:00, 2025-12-20 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__3572673861' (evaluator.py:984)
2025-12-19 21:48:08,379 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ DELETE FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3572673861" WHERE "event_date" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2025-12-19' AS DATE) (base.py:2619)
2025-12-19 21:48:08,380 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ INSERT INTO "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3572673861" ("id", "item_id", "event_date") SELECT "id", "item_id", "event_date" FROM (SELECT "seed_model"."id" AS "id", "seed_model"."item_id" AS "item_id", "seed_model"."event_date" AS "event_date" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2437004170" AS "seed_model" WHERE "seed_model"."event_date" <= CAST('2025-12-19' AS DATE) AND "seed_model"."event_date" >= CAST('2020-01-01' AS DATE)) AS "_subquery" WHERE "event_date" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2025-12-19' AS DATE) (base.py:2619)
2025-12-19 21:48:08,380 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2020-01-01 00:00:00, 2025-12-20 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 931077548> (facade.py:637)
2025-12-19 21:48:08,380 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 931077548> (interval.py:215)
2025-12-19 21:48:08,384 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 4289879592> (evaluator.py:711)
2025-12-19 21:48:08,384 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 4289879592> (evaluator.py:952)
2025-12-19 21:48:08,386 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-12-19 00:00:00, 2025-12-20 00:00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__635791289' (evaluator.py:984)
2025-12-19 21:48:08,386 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-19 21:48:08,386 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT type FROM DUCKDB_DATABASES() WHERE database_name = 'db' (base.py:2619)
2025-12-19 21:48:08,387 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__635791289" AS SELECT CAST("item_id" AS INT) AS "item_id", CAST("num_orders" AS BIGINT) AS "num_orders" FROM (SELECT "incremental_model"."item_id" AS "item_id", COUNT(DISTINCT "incremental_model"."id") AS "num_orders" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3572673861" AS "incremental_model" GROUP BY "incremental_model"."item_id") AS "_subquery" (base.py:2619)
2025-12-19 21:48:08,388 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 4289879592> (evaluator.py:603)
2025-12-19 21:48:08,389 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__635791289" (base.py:2619)
2025-12-19 21:48:08,390 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT COUNT(*) FROM (SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__635791289" AS "sqlmesh_example__full_model__635791289" WHERE "item_id" < 0) AS "audit" (base.py:2619)
2025-12-19 21:48:08,390 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-12-19 00:00:00, 2025-12-20 00:00:00) for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 4289879592> (facade.py:637)
2025-12-19 21:48:08,390 - MainThread - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 4289879592> (interval.py:215)
2025-12-19 21:48:08,395 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:123)
2025-12-19 21:48:08,395 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'dev' (facade.py:167)
2025-12-19 21:48:08,400 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:123)
2025-12-19 21:48:08,401 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh_example__dev' (evaluator.py:1449)
2025-12-19 21:48:08,401 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh_example__dev" (base.py:2619)
2025-12-19 21:48:08,402 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh_example__dev (evaluator.py:1616)
2025-12-19 21:48:08,402 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-19 21:48:08,402 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT CURRENT_CATALOG() (base.py:2619)
2025-12-19 21:48:08,402 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM system.information_schema.tables WHERE (table_catalog = 'db' AND table_schema = 'sqlmesh_example__dev') AND table_name IN ('seed_model', 'full_model', 'incremental_model') (base.py:2619)
2025-12-19 21:48:08,404 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.seed_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__2437004170' (evaluator.py:1988)
2025-12-19 21:48:08,405 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."seed_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__2437004170" (base.py:2619)
2025-12-19 21:48:08,406 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.incremental_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__3572673861' (evaluator.py:1988)
2025-12-19 21:48:08,406 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."incremental_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__3572673861" (base.py:2619)
2025-12-19 21:48:08,407 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.full_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__635791289' (evaluator.py:1988)
2025-12-19 21:48:08,407 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: /* SQLMESH_PLAN: f13890ac07ee4385a69e70aa88330614 */ CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."full_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__635791289" (base.py:2619)
2025-12-19 21:48:08,408 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:123)
2025-12-19 21:48:08,408 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'dev' (environment.py:141)
2025-12-19 21:48:08,416 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
